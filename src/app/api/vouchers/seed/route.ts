/* eslint-disable @typescript-eslint/no-explicit-any */
import { NextResponse } from 'next/server';
import { supabase } from '@/lib/supabase';

const initialVouchers = [
  { code: "WELCOME10", name: "Welcome 10%", type: "percentage", value: 10, category: "Coffee Shop", company_name: "Coffee House", province: "B√¨nh D∆∞∆°ng", district: "Th·ªß D·∫ßu M·ªôt", google_map_link: "https://maps.google.com/?q=Coffee+House", status: "active", quantity_used: 45, quantity_total: 100, start_date: "2025-01-01", end_date: "2025-12-31", image: "https://images.unsplash.com/photo-1453614512568-c4024d13c247?w=400&h=300&fit=crop" },
  { code: "SAVE50", name: "Save 50k", type: "fixed", value: 50000, category: "Supermarket", company_name: "Market Box", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 1", google_map_link: "https://maps.google.com/?q=Market+Box", status: "inactive", quantity_used: 0, quantity_total: 200, start_date: "2025-06-01", end_date: "2025-09-30", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" },
  { code: "SPRING15", name: "Spring 15%", type: "percentage", value: 15, category: "Restaurant", company_name: "Maisa", province: "B√¨nh D∆∞∆°ng", district: "Dƒ© An", google_map_link: "https://maps.google.com/?q=Maisa+Restaurant", status: "active", quantity_used: 89, quantity_total: 150, start_date: "2025-03-01", end_date: "2025-05-31", image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=300&fit=crop" },
  { code: "POOL20", name: "Pool Pass 20%", type: "percentage", value: 20, category: "Pool", company_name: "Vincom", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 2", google_map_link: "https://maps.google.com/?q=Vincom+Pool", status: "inactive", quantity_used: 200, quantity_total: 200, start_date: "2025-01-15", end_date: "2025-12-15", image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop" },
  { code: "CGV100", name: "CGV 100k Off", type: "fixed", value: 100000, category: "Fest", company_name: "CGV", province: "B√¨nh D∆∞∆°ng", district: "Th·ªß D·∫ßu M·ªôt", google_map_link: "https://maps.google.com/?q=CGV+Cinema", status: "active", quantity_used: 123, quantity_total: 500, start_date: "2025-02-01", end_date: "2025-11-30", image: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?w=400&h=300&fit=crop" },
  { code: "COFFEE25", name: "Coffee 25% Off", type: "percentage", value: 25, category: "Coffee Shop", company_name: "CONG Coffee", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 3", google_map_link: "https://maps.google.com/?q=CONG+Coffee", status: "active", quantity_used: 67, quantity_total: 100, start_date: "2025-01-10", end_date: "2025-12-20", image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop" },
  { code: "STORE30", name: "Store 30k", type: "fixed", value: 30000, category: "Convenience Store", company_name: "Becamex Store", province: "B√¨nh D∆∞∆°ng", district: "Thu·∫≠n An", google_map_link: "https://maps.google.com/?q=Becamex+Store", status: "inactive", quantity_used: 50, quantity_total: 50, start_date: "2025-03-05", end_date: "2025-08-05", image: "https://images.unsplash.com/photo-1472851294608-062f824d29cc?w=400&h=300&fit=crop" },
  { code: "MEAL15", name: "Meal Discount 15%", type: "percentage", value: 15, category: "Restaurant", company_name: "Maisa", province: "H√† N·ªôi", district: "Ho√†n Ki·∫øm", google_map_link: "https://maps.google.com/?q=Maisa+Restaurant", status: "active", quantity_used: 234, quantity_total: 1000, start_date: "2025-01-01", end_date: "2025-12-31", image: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=300&fit=crop" },
  { code: "FRESH40", name: "Fresh 40k", type: "fixed", value: 40000, category: "Supermarket", company_name: "Market Box", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 7", google_map_link: "https://maps.google.com/?q=Market+Box", status: "inactive", quantity_used: 15, quantity_total: 100, start_date: "2025-04-01", end_date: "2025-07-31", image: "https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=400&h=300&fit=crop" },
  { code: "SWIM10", name: "Swim 10%", type: "percentage", value: 10, category: "Pool", company_name: "Vincom", province: "B√¨nh D∆∞∆°ng", district: "Dƒ© An", google_map_link: "https://maps.google.com/?q=Vincom+Pool", status: "active", quantity_used: 78, quantity_total: 200, start_date: "2025-02-10", end_date: "2025-12-10", image: "https://images.unsplash.com/photo-1530549387789-4c1017266635?w=400&h=300&fit=crop" },
  { code: "MOVIE50", name: "Movie Night 50k", type: "fixed", value: 50000, category: "Fest", company_name: "CGV", province: "H√† N·ªôi", district: "C·∫ßu Gi·∫•y", google_map_link: "https://maps.google.com/?q=CGV+Cinema", status: "active", quantity_used: 450, quantity_total: 800, start_date: "2025-01-20", end_date: "2025-10-20", image: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?w=400&h=300&fit=crop" },
  { code: "BREW20", name: "Brew Time 20%", type: "percentage", value: 20, category: "Coffee Shop", company_name: "Coffee House", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 1", google_map_link: "https://maps.google.com/?q=Coffee+House", status: "active", quantity_used: 12, quantity_total: 75, start_date: "2025-01-05", end_date: "2025-12-25", image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=400&h=300&fit=crop" },
  { code: "SNACK15", name: "Snack 15k", type: "fixed", value: 15000, category: "Convenience Store", company_name: "Becamex Store", province: "B√¨nh D∆∞∆°ng", district: "Th·ªß D·∫ßu M·ªôt", google_map_link: "https://maps.google.com/?q=Becamex+Store", status: "active", quantity_used: 0, quantity_total: 300, start_date: "2025-02-15", end_date: "2025-09-15", image: "https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=400&h=300&fit=crop" },
  { code: "DINE25", name: "Dine Out 25%", type: "percentage", value: 25, category: "Restaurant", company_name: "Maisa", province: "H√† N·ªôi", district: "ƒê·ªëng ƒêa", google_map_link: "https://maps.google.com/?q=Maisa+Restaurant", status: "inactive", quantity_used: 100, quantity_total: 100, start_date: "2025-03-10", end_date: "2025-08-10", image: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5?w=400&h=300&fit=crop" },
  { code: "MART60", name: "Mart Special 60k", type: "fixed", value: 60000, category: "Supermarket", company_name: "Market Box", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 2", google_map_link: "https://maps.google.com/?q=Market+Box", status: "active", quantity_used: 567, quantity_total: 1000, start_date: "2025-01-25", end_date: "2025-11-25", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" },
  { code: "AQUA30", name: "Aqua Fun 30%", type: "percentage", value: 30, category: "Pool", company_name: "Vincom", province: "B√¨nh D∆∞∆°ng", district: "Thu·∫≠n An", google_map_link: "https://maps.google.com/?q=Vincom+Pool", status: "inactive", quantity_used: 25, quantity_total: 50, start_date: "2025-04-05", end_date: "2025-09-05", image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop" },
  { code: "CINEMA70", name: "Cinema Pass 70k", type: "fixed", value: 70000, category: "Fest", company_name: "CGV", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 3", google_map_link: "https://maps.google.com/?q=CGV+Cinema", status: "active", quantity_used: 89, quantity_total: 250, start_date: "2025-02-20", end_date: "2025-12-20", image: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?w=400&h=300&fit=crop" },
  { code: "LATTE18", name: "Latte Lover 18%", type: "percentage", value: 18, category: "Coffee Shop", company_name: "CONG Coffee", province: "H√† N·ªôi", district: "Ba ƒê√¨nh", google_map_link: "https://maps.google.com/?q=CONG+Coffee", status: "active", quantity_used: 150, quantity_total: 150, start_date: "2025-01-15", end_date: "2025-10-15", image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop" },
  { code: "QUICK20", name: "Quick Shop 20k", type: "fixed", value: 20000, category: "Convenience Store", company_name: "Becamex Store", province: "B√¨nh D∆∞∆°ng", district: "Dƒ© An", google_map_link: "https://maps.google.com/?q=Becamex+Store", status: "active", quantity_used: 34, quantity_total: 100, start_date: "2025-03-01", end_date: "2025-11-01", image: "https://images.unsplash.com/photo-1472851294608-062f824d29cc?w=400&h=300&fit=crop" },
  { code: "FEAST30", name: "Feast Time 30%", type: "percentage", value: 30, category: "Restaurant", company_name: "Maisa", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 7", google_map_link: "https://maps.google.com/?q=Maisa+Restaurant", status: "active", quantity_used: 401, quantity_total: 500, start_date: "2025-01-08", end_date: "2025-12-08", image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=300&fit=crop" },
  { code: "GROCERY80", name: "Grocery 80k", type: "fixed", value: 80000, category: "Supermarket", company_name: "Market Box", province: "H√† N·ªôi", district: "Ho√†n Ki·∫øm", google_map_link: "https://maps.google.com/?q=Market+Box", status: "inactive", quantity_used: 75, quantity_total: 75, start_date: "2025-02-12", end_date: "2025-09-12", image: "https://images.unsplash.com/photo-1578916171728-46686eac8d58?w=400&h=300&fit=crop" },
  { code: "SPLASH12", name: "Splash Day 12%", type: "percentage", value: 12, category: "Pool", company_name: "Vincom", province: "B√¨nh D∆∞∆°ng", district: "Th·ªß D·∫ßu M·ªôt", google_map_link: "https://maps.google.com/?q=Vincom+Pool", status: "active", quantity_used: 56, quantity_total: 200, start_date: "2025-01-30", end_date: "2025-12-30", image: "https://images.unsplash.com/photo-1530549387789-4c1017266635?w=400&h=300&fit=crop" },
  { code: "SHOW90", name: "Show Time 90k", type: "fixed", value: 90000, category: "Fest", company_name: "CGV", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 1", google_map_link: "https://maps.google.com/?q=CGV+Cinema", status: "inactive", quantity_used: 10, quantity_total: 100, start_date: "2025-03-15", end_date: "2025-08-15", image: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?w=400&h=300&fit=crop" },
  { code: "ESPRESSO22", name: "Espresso Deal 22%", type: "percentage", value: 22, category: "Coffee Shop", company_name: "Coffee House", province: "H√† N·ªôi", district: "C·∫ßu Gi·∫•y", google_map_link: "https://maps.google.com/?q=Coffee+House", status: "active", quantity_used: 45, quantity_total: 120, start_date: "2025-01-12", end_date: "2025-11-12", image: "https://images.unsplash.com/photo-1453614512568-c4024d13c247?w=400&h=300&fit=crop" },
  { code: "GRAB25", name: "Grab & Go 25k", type: "fixed", value: 25000, category: "Convenience Store", company_name: "Becamex Store", province: "B√¨nh D∆∞∆°ng", district: "Thu·∫≠n An", google_map_link: "https://maps.google.com/?q=Becamex+Store", status: "active", quantity_used: 80, quantity_total: 80, start_date: "2025-02-25", end_date: "2025-10-25", image: "https://images.unsplash.com/photo-1604719312566-8912e9227c6a?w=400&h=300&fit=crop" },
  { code: "GOURMET35", name: "Gourmet 35%", type: "percentage", value: 35, category: "Restaurant", company_name: "Maisa", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 2", google_map_link: "https://maps.google.com/?q=Maisa+Restaurant", status: "active", quantity_used: 123, quantity_total: 300, start_date: "2025-01-18", end_date: "2025-12-18", image: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=400&h=300&fit=crop" },
  { code: "FRESH100", name: "Fresh Pick 100k", type: "fixed", value: 100000, category: "Supermarket", company_name: "Market Box", province: "H√† N·ªôi", district: "ƒê·ªëng ƒêa", google_map_link: "https://maps.google.com/?q=Market+Box", status: "active", quantity_used: 234, quantity_total: 600, start_date: "2025-03-20", end_date: "2025-11-20", image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" },
  { code: "DIVE15", name: "Dive In 15%", type: "percentage", value: 15, category: "Pool", company_name: "Vincom", province: "B√¨nh D∆∞∆°ng", district: "Dƒ© An", google_map_link: "https://maps.google.com/?q=Vincom+Pool", status: "inactive", quantity_used: 30, quantity_total: 30, start_date: "2025-02-05", end_date: "2025-09-05", image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop" },
  { code: "EVENT60", name: "Event Special 60k", type: "fixed", value: 60000, category: "Fest", company_name: "CGV", province: "H·ªì Ch√≠ Minh", district: "Qu·∫≠n 3", google_map_link: "https://maps.google.com/?q=CGV+Cinema", status: "active", quantity_used: 178, quantity_total: 400, start_date: "2025-01-22", end_date: "2025-12-22", image: "https://images.unsplash.com/photo-1440404653325-ab127d49abc1?w=400&h=300&fit=crop" },
  { code: "MOCHA28", name: "Mocha Magic 28%", type: "percentage", value: 28, category: "Coffee Shop", company_name: "CONG Coffee", province: "H√† N·ªôi", district: "Ba ƒê√¨nh", google_map_link: "https://maps.google.com/?q=CONG+Coffee", status: "active", quantity_used: 67, quantity_total: 150, start_date: "2025-01-28", end_date: "2025-11-28", image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop" },
];

export async function POST() {
  try {
    console.log('üìä Starting vouchers seed...');
    console.log(`   Total vouchers to seed: ${initialVouchers.length}`);

    const { error, count } = await (supabase as any)
      .from('vouchers')
      .upsert(initialVouchers, { onConflict: 'code', count: 'exact' });

    if (error) {
      console.error('‚ùå Seed error:', error);
      return NextResponse.json({ error: 'Failed to seed vouchers', details: error.message }, { status: 500 });
    }

    console.log(`‚úÖ Successfully seeded ${count} vouchers`);
    return NextResponse.json({ 
      ok: true, 
      message: 'Vouchers seeded successfully',
      count 
    });
  } catch (err) {
    const message = err instanceof Error ? err.message : String(err);
    console.error('‚ùå Unexpected error:', message);
    return NextResponse.json({ error: 'Unexpected error', details: message }, { status: 500 });
  }
}
